# Vulneribility
 In the function nft_trans_gc_catchall, maintainers forget to remove the catchall set element from the catchall_list when the argument sync is true. So if you create a catchall set element with NFT_SET_EXT_EXPIRATION in a pipapo set, it's possible to free the catchall set element many times.


## Requirements to trigger the vulnerability
 - Capabilities:  `CAP_NET_ADMIN` capability is required.
 - Kernel configuration: `CONFIG_NETFILTER`, `CONFIG_NF_TABLES`
 - Are user namespaces needed?: Yes
  
## Commit which introduced the vulnerability
 - [commit 4a9e12ea7e70223555ec010bec9f711089ce96f6](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/net/netfilter?id=4a9e12ea7e70223555ec010bec9f711089ce96f6)

## Commit which fixed the vulnerability
- [commit 93995bf4af2c5a99e2a87f0cd5ce547d31eb7630](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=93995bf4af2c5a99e2a87f0cd5ce547d31eb7630)

## Affected kernel versions
- 6.1.56 and later
- 5.15.134 and later

## Affected component, subsystem
- net/netfilter (nf_tables)

## Cause
- UAF


# Vulneribility
 In function nft_pipapo_walk of file /net/netfilter/nft_set_pipapo.c, it doesn't check if an element is active like other similar functions. This may lead to double-deactivations of elements which then results in memory corruption.

## Requirements to trigger the vulnerability
 - Capabilities:  `CAP_NET_ADMIN` capability is required.
 - Kernel configuration: `CONFIG_NETFILTER`, `CONFIG_NF_TABLES`
 - Are user namespaces needed?: Yes
  
## Commit which introduced the vulnerability
 - [commit 3c4287f62044a90e73a561aa05fc46e62da173da](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/net/netfilter/nft_set_pipapo.c?id=3c4287f62044a90e73a561aa05fc46e62da173da)

## Commit which fixed the vulnerability
- [commit 317eb9685095678f2c9f5a8189de698c5354316a](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=317eb9685095678f2c9f5a8189de698c5354316a)

## Affected kernel versions
- 5.6-rc1 and later.

## Affected component, subsystem
- net/netfilter (nf_tables)

## Cause
- UAF

